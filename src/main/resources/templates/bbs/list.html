<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Êé≤Á§∫Êùø - Êµ∑Â§ñ„Çµ„ÉÉ„Ç´„Éº„Éã„É•„Éº„Çπ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans JP', 'Hiragino Kaku Gothic Pro', 'Meiryo', sans-serif;
        }
        .thread-row {
            font-size: 13px;
            line-height: 1.4;
        }
        .thread-title {
            font-weight: 500;
        }
        .new-badge {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- „Éò„ÉÉ„ÉÄ„Éº -->
    <header class="bg-blue-600 text-white shadow-md">
        <div class="container mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <h1 class="text-2xl font-bold">‚öΩ Êµ∑Â§ñ„Çµ„ÉÉ„Ç´„ÉºÊé≤Á§∫Êùø</h1>
                <nav class="space-x-4">
                    <a href="/" class="hover:underline">„Éã„É•„Éº„Çπ</a>
                    <a href="/players" class="hover:underline">Êó•Êú¨‰∫∫ÈÅ∏Êâã</a>
                    <a href="/bbs" class="hover:underline font-bold">Êé≤Á§∫Êùø</a>
                </nav>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4 py-6">
        <!-- „Éï„É©„ÉÉ„Ç∑„É•„É°„ÉÉ„Çª„Éº„Ç∏ -->
        <div th:if="${success}" class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4">
            <span th:text="${success}"></span>
        </div>
        <div th:if="${error}" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
            <span th:text="${error}"></span>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
            <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
            <div class="lg:col-span-3">
                <!-- Êìç‰Ωú„Éê„Éº -->
                <div class="bg-white rounded-lg shadow-sm p-4 mb-4">
                    <div class="flex flex-wrap gap-4 items-center justify-between">
                        <!-- „Ç´„ÉÜ„Ç¥„É™„Éï„Ç£„É´„Çø -->
                        <div class="flex flex-wrap gap-2">
                            <a th:each="cat : ${categories}" 
                               th:href="@{/bbs(category=${cat})}"
                               th:classappend="${selectedCategory == cat} ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'"
                               class="px-3 py-1 rounded text-sm font-medium transition">
                                <span th:text="${cat}"></span>
                            </a>
                        </div>
                        
                        <!-- Êñ∞Ë¶è„Çπ„É¨„ÉÉ„Éâ‰ΩúÊàê„Éú„Çø„É≥ -->
                        <a href="/bbs/new" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded font-bold transition">
                            ‚úèÔ∏è Êñ∞Ë¶è„Çπ„É¨„ÉÉ„Éâ‰ΩúÊàê
                        </a>
                    </div>
                    
                    <!-- Ê§úÁ¥¢„Éï„Ç©„Éº„É† -->
                    <form method="get" action="/bbs" class="mt-4">
                        <div class="flex gap-2">
                            <input type="text" name="keyword" th:value="${keyword}" 
                                   placeholder="„Ç≠„Éº„ÉØ„Éº„ÉâÊ§úÁ¥¢..." 
                                   class="flex-1 px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded font-medium transition">
                                üîç Ê§úÁ¥¢
                            </button>
                        </div>
                    </form>
                </div>

                <!-- „Çπ„É¨„ÉÉ„Éâ‰∏ÄË¶ß -->
                <div class="bg-white rounded-lg shadow-sm overflow-hidden">
                    <!-- „Éò„ÉÉ„ÉÄ„Éº -->
                    <div class="bg-gray-200 border-b-2 border-gray-400 px-3 py-1.5 text-xs font-bold text-gray-800 grid grid-cols-12 gap-2">
                        <div class="col-span-7">„Çø„Ç§„Éà„É´</div>
                        <div class="col-span-2 text-center">ÊäïÁ®øËÄÖ</div>
                        <div class="col-span-1 text-center">„É¨„Çπ</div>
                        <div class="col-span-1 text-center">üëç</div>
                        <div class="col-span-1 text-center">Êó•ÊôÇ</div>
                    </div>

                    <!-- „Çπ„É¨„ÉÉ„Éâ‰∏ÄË¶ß -->
                    <div th:if="${posts.isEmpty()}" class="p-8 text-center text-gray-500">
                        „Çπ„É¨„ÉÉ„Éâ„Åå„ÅÇ„Çä„Åæ„Åõ„Çì
                    </div>
                    
                    <div th:each="post : ${posts.content}" 
                         class="border-b border-gray-200 hover:bg-blue-50 transition thread-row">
                        <a th:href="@{/bbs/{id}(id=${post.id})}" 
                           class="px-3 py-2 grid grid-cols-12 gap-2 items-center">
                            <!-- „Çø„Ç§„Éà„É´ -->
                            <div class="col-span-7 flex items-center gap-1">
                                <span class="inline-block bg-blue-600 text-white text-xs px-1.5 py-0.5 rounded font-medium flex-shrink-0" 
                                      th:text="${post.category}"></span>
                                <span class="thread-title text-gray-900 hover:text-blue-600 hover:underline" 
                                      th:text="${post.title}"></span>
                                <span class="text-red-600 text-xs ml-1" 
                                      th:text="'(' + ${post.commentCount} + ')'"
                                      th:if="${post.commentCount > 0}"></span>
                                <span class="new-badge text-red-600 text-xs font-bold ml-1" 
                                      th:if="${#temporals.format(post.createdAt, 'yyyy-MM-dd').equals(#temporals.format(#temporals.createNow(), 'yyyy-MM-dd'))}">NEW</span>
                            </div>
                            
                            <!-- ÊäïÁ®øËÄÖ -->
                            <div class="col-span-2 text-center text-gray-700 text-xs truncate" th:text="${post.author}"></div>
                            
                            <!-- „É¨„ÇπÊï∞ -->
                            <div class="col-span-1 text-center">
                                <span class="text-orange-600 font-bold text-xs" 
                                      th:text="${post.commentCount}"></span>
                            </div>
                            
                            <!-- „Åä„Åô„Åô„ÇÅÊï∞ -->
                            <div class="col-span-1 text-center">
                                <span class="text-red-600 font-bold text-xs" th:text="${post.recommendCount}"></span>
                            </div>
                            
                            <!-- Êó•ÊôÇ -->
                            <div class="col-span-1 text-center text-gray-600 text-xs" 
                                 th:text="${#temporals.format(post.createdAt, 'MM/dd HH:mm')}"></div>
                        </a>
                    </div>
                </div>

                <!-- „Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥ -->
                <div th:if="${totalPages > 1}" class="mt-4 flex justify-center gap-2">
                    <a th:if="${currentPage > 0}" 
                       th:href="@{/bbs(page=${currentPage - 1}, category=${selectedCategory}, keyword=${keyword})}"
                       class="px-4 py-2 bg-white border border-gray-300 rounded hover:bg-gray-100 transition">
                        ‚Üê Ââç„Å∏
                    </a>
                    
                    <span class="px-4 py-2 bg-blue-600 text-white rounded font-bold">
                        <span th:text="${currentPage + 1}"></span> / <span th:text="${totalPages}"></span>
                    </span>
                    
                    <a th:if="${currentPage < totalPages - 1}" 
                       th:href="@{/bbs(page=${currentPage + 1}, category=${selectedCategory}, keyword=${keyword})}"
                       class="px-4 py-2 bg-white border border-gray-300 rounded hover:bg-gray-100 transition">
                        Ê¨°„Å∏ ‚Üí
                    </a>
                </div>
            </div>

            <!-- „Çµ„Ç§„Éâ„Éê„Éº -->
            <div class="lg:col-span-1">
                <!-- Êó•Êú¨‰∫∫ÈÅ∏ÊâãÈÄüÂ†± -->
                <div class="bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg shadow-md p-4 mb-4 text-white" th:if="${topPlayers != null && !topPlayers.isEmpty()}">
                    <h3 class="font-bold text-lg mb-3 border-b border-blue-400 pb-2">‚öΩ Êó•Êú¨‰∫∫ÈÅ∏ÊâãÈÄüÂ†±</h3>
                    <div class="space-y-3">
                        <div th:each="player : ${topPlayers}" class="bg-white bg-opacity-10 rounded p-2 hover:bg-opacity-20 transition">
                            <div class="flex items-center justify-between mb-1">
                                <span class="font-bold text-sm" th:text="${player.playerName}"></span>
                                <span class="text-xs bg-white bg-opacity-20 px-2 py-0.5 rounded" th:text="${player.league}"></span>
                            </div>
                            <div class="text-xs opacity-90" th:text="${player.teamName}"></div>
                            <div class="flex items-center gap-3 mt-2 text-xs">
                                <span>‚öΩ <span th:text="${player.goals}"></span></span>
                                <span>üéØ <span th:text="${player.assists}"></span></span>
                                <span>üìä <span th:text="${player.matchesPlayed}"></span>Ë©¶Âêà</span>
                            </div>
                            <div th:if="${player.hasLatestMatch()}" class="mt-2 text-xs bg-white bg-opacity-10 rounded px-2 py-1">
                                <div class="flex items-center justify-between">
                                    <span th:text="${player.latestOpponent}"></span>
                                    <span class="font-bold" th:text="${player.latestResult}"></span>
                                </div>
                                <div class="mt-1 opacity-75">
                                    Ë©ï‰æ°: <span th:text="${player.latestRating}"></span> | 
                                    Ëµ∞Ë°å: <span th:text="${player.latestDistance}"></span>km
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ‰∫∫Ê∞ó„Çπ„É¨„ÉÉ„Éâ -->
                <div class="bg-white rounded-lg shadow-sm p-4 mb-4">
                    <h3 class="font-bold text-lg mb-3 text-gray-800 border-b pb-2">üî• ‰∫∫Ê∞ó„Çπ„É¨„ÉÉ„Éâ</h3>
                    <div class="space-y-2">
                        <a th:each="topPost : ${topPosts}" 
                           th:href="@{/bbs/{id}(id=${topPost.id})}"
                           class="block p-2 hover:bg-gray-50 rounded transition">
                            <div class="text-sm font-medium text-gray-900 truncate" th:text="${topPost.title}"></div>
                            <div class="text-xs text-gray-500 mt-1">
                                üëç <span th:text="${topPost.recommendCount}"></span> | 
                                üí¨ <span th:text="${topPost.commentCount}"></span>
                            </div>
                        </a>
                    </div>
                </div>

                <!-- Êé≤Á§∫Êùø„Ç¨„Ç§„Éâ -->
                <div class="bg-white rounded-lg shadow-sm p-4">
                    <h3 class="font-bold text-lg mb-3 text-gray-800 border-b pb-2">üìå Êé≤Á§∫Êùø„Ç¨„Ç§„Éâ</h3>
                    <ul class="text-sm text-gray-600 space-y-2">
                        <li>‚Ä¢ „É≠„Ç∞„Ç§„É≥‰∏çË¶Å„ÅßÊäïÁ®øÂèØËÉΩ</li>
                        <li>‚Ä¢ ÂâäÈô§Áî®„Éë„Çπ„ÉØ„Éº„Éâ„ÇíË®≠ÂÆö</li>
                        <li>‚Ä¢ Ë™πË¨ó‰∏≠ÂÇ∑„ÅØÁ¶ÅÊ≠¢</li>
                        <li>‚Ä¢ „Çµ„ÉÉ„Ç´„ÉºÈñ¢ÈÄ£„ÅÆË©±È°å„Çí</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- „Éï„ÉÉ„Çø„Éº -->
    <footer class="bg-gray-800 text-white text-center py-6 mt-12">
        <p>&copy; 2026 Êµ∑Â§ñ„Çµ„ÉÉ„Ç´„Éº„Éã„É•„Éº„ÇπÊé≤Á§∫Êùø</p>
    </footer>
</body>
</html>
